<!--HTML Seite, die das Video und saemtliche Zustandsdaten des Raspberry Pi anzeigt-->

<!DOCTYPE HTML>
<html>
  <head>
    <title>IKT CAR MONITORING</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">
    <script type="text/javascript" src="smoothie.js"></script>
    <style>
      body {
        background: #555;
        text-align: left;
        margin-top: 1%;
        zoom: 100%;
        
      }
      p {
        color:white;
        max-width: 50%;
      }
      th {
        color:white;
      }
      #column {
        width: 50%;  
        float: left;
        position: relative;
      }
    </style>	
  </head>

  <body>
	  <!--Aufgabe 4-->
    <!--Für jeden Datensatz muss eine Zeichenfläche 'canvas' definiert werden-->
    <div class="container">
      <div class="row">
        <div class="col">
          <p> Geschwindigkeit des Modellautos: </p>
          <canvas class="canvas" id="speedChart" width="200" height="100">
          </canvas>
        </div>

        <div class="col">
          <p> HimmelRichtung: </p>
          <canvas class="canvas" id="himmelChart" width="200" height="100">
          </canvas>
        </div>
      </div>

      <div class="row">
        <div class="col">
          <p> Abstand zum Hindernis: </p>
          <canvas class="canvas" id="abstandChart" width="200" height="100">
          </canvas>
        </div>

        <div class="col">
          <p> Länge der Parklücke: </p>
          <canvas class="canvas" id="laengeChart" width="200" height="100">
          </canvas>
        </div>
      </div>
    </div>

     <!--Einparken -->
    <!--Es müssen Knöpfe zum Starten und Stoppen des Parkvorgangs definiert werden-->
    <div class="container">
      <button class="btn btn-primary btn-success"> Start Parking </button>
      <button class="btn btn-primary btn-warning"> Stop Parking process </button>
    </div>

    <script type="text/javascript">
        var dataSocket = new WebSocket("ws://172.23.90.34:8081/ws");
        dataSocket.onopen = function() {
            console.log("connected");
            dataSocket.send("connection established");
        };

        dataSocket.onmessage = function(evt) {
            console.log(evt.data);
            dataSocket.send("Message received!");
            var msg = JSON.parse(evt.data);
            console.log(msg)
            speed.append(new Date().getTime(), parseFloat(msg.e_t.speed));
            himmel.append(new Date().getTime(), parseFloat(msg.c_t.bearing));
            abstand.append(new Date().getTime(), parseFloat(msg.e_t.distance));
            speed.append(new Date().getTime(), parseFloat(msg.i_t.parking_space_length));
        }

        // SpeedChart
        var speedChart = new SmoothieChart({minValue: 0, maxValue: 300,
                grid: {strokeStyle: "rgb(125,0,0)", fillStyle: "rgb(60,0,0)",
                       lineWidth: 1, millisPerLine: 250, verticalSections:6}
                });

        // HimmelChart
        var himmelChart = new SmoothieChart({minValue: 0, maxValue: 300,
                grid: {strokeStyle: "rgb(125,0,0)", fillStyle: "rgb(60,0,0)",
                       lineWidth: 1, millisPerLine: 250, verticalSections:6}
                });

        // SmoothieChart
        var abstandChart = new SmoothieChart({minValue: 0, maxValue: 300,
                grid: {strokeStyle: "rgb(125,0,0)", fillStyle: "rgb(60,0,0)",
                       lineWidth: 1, millisPerLine: 250, verticalSections:6}
                });

        // SmoothieChart
        var laengeChart = new SmoothieChart({minValue: 0, maxValue: 300,
                grid: {strokeStyle: "rgb(125,0,0)", fillStyle: "rgb(60,0,0)",
                       lineWidth: 1, millisPerLine: 250, verticalSections:6}
                });

        //speed
        var speed = new TimeSeries();
        sppedChart.addTimeSeries(speed);
        speedChart.streamTo(document.getElementById("speedChart"), 100);

        //Himmelrichtung
        var himmel = new TimeSeries();
        himmelChart.addTimeSeries(himmel);
        himmelChart.streamTo(document.getElementById("himmelsChart"), 100);

        //Abstand zum Hindernis
        var abstand = new TimeSeries();
        abstandChart.addTimeSeries(abstand);
        abstandChart.streamTo(document.getElementById("abstandChart"), 100);

        //speed
        var laenge = new TimeSeries();
        laengeChart.addTimeSeries(laenge);
        laengeChart.streamTo(document.getElementById("laengeChart"), 100);
    </script>
  </body>
</html>